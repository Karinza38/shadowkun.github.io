---                                                                                                                                                                                              
  layout: post
  title: AI Programming
---

## 智能化：人机协同的编程方式

> 在imgcook.com发布之后，我们在掘金、知乎、微信朋友圈和公众号发表了很多文章，收获最多的反馈是：前端要失业了。按照现在的趋势来看，对P5左右的初级前端工程师的需求，将大幅度降低。imgcook.com官网底部有数据，从数据可以看到，今天在UI生成和逻辑代码生成方面，已经可以替代P5前端工程师完成近80%的工作。无论趋势还是数据，都能看到传统前端低技术价值、高重复的工作正走向消亡。
如马云先生在香港对年轻人传授创业经验时讲到的，蒸汽机和电力解放了人类的体力，人工智能和机器学习解放了人类的脑力。以此为寓，P5前端的大部分工作脑力含量远低于体力含量。马云先生在评价蒸汽机和电力带来的失业问题时讲到，人类在科技进步下从繁重的体力劳动中解放出来，逐步向脑力劳动过渡，这是人类社会的进步。今天前端从P5重复劳动的施工队里解放出来，逐步向智能化的高技术含量工程师过渡，这是前端技术的进步。
综上所述，今天你已经无法绕过智能化命题了，就像让当今社会的人去做蒸汽机、内燃机、电机的工作，回不去了。预见到如此未来的降临，我们联合Google的Tensorflow.js团队，推出了github.com/alibaba/pipcook 项目，试图帮助前端零成本进入智能化，用这个框架轻松打通智能化的任督二脉：连接前端技术生态、复用Python技术生态。因此，后文将在Pipcook框架的基础上，从概念到方法、从方法到实践、从工具到应用的方式，和大家分享：前端部分失业后去做什么？怎么做？


## 历史

在此先回顾一下前端技术发展的脉络，以期从脉络中为大家整理出技术发展的规律，从而引出智能化的发端。HTML和CSS是第一阶段，超文本协议下承载图文内容，是前端技术最初的样子。生产过程大致是网页三剑客：Dreamweaver、Fireworks、Flash，Fireworks用来切图，Dreamweaver用来以所见即所得的方式编辑HTML和CSS，Flash用来实现富媒体体验如：音频、动画、视频等。这时网页还是静态的，在设计和实现的过程中决定了最终展示给用户的内容和样式。

引入脚本能力的DHTML是第二阶段，DHTML带来了BOM体系，脚本带来了逻辑控制和数据处理能力，两者合二为一成就了网页动态化能力。所谓动态化能力是指，在网页设计和实现之后，在运行时脚本和BOM结合对DOM进行操作，对网页内容和样式进行改变。生产过程除了Dreamweaver里具备了脚本编辑、调试、代码段儿管理，可基本完成动态页面开发工作，还有比较专业的IDE出现。浏览器端脚本也从VBScript、JScript、Javascript统一到Javascript，Flash长出了Action Script和Flex技术，微软也提出Silverlight技术把 .Net 语言引入，还有XHTML技术体系中给予XML和XSLT的XPath脚本等。

HTTPWebRequest对象加持下JQuery、Prototype等框架的出现，在维持原有的动态化能力外，统一收敛了脚本的能力，在框架内抽象为：网络能力、数据能力、DOM操作能力、Bridge能力，生产过程从原始的文件组织升级到各种脚手架初始化和辅助开发，从Ctrl+C和Ctrl+V的代码片段式升级到Library和Module方式，增加了代码的复用度、可读性和可维护性，因此，前端技术加持下出现了更加复杂的Single Page Application和Web Application。

随着Library和Module无法满足业务诉求，Component用更加细粒度的抽象提供了更丰富的业务承载力，生产过程也从直接开发、现场施工进化到间接开发、预制施工，完成产品的环节从研发进入搭建。这种生产方式适合成熟产品和领域，因为需要从业务角度进行抽象，否则，难以拥有足够可用的Component实现产品。对于新产品和新业务，没有足够的代码、组件、模块、库、框架、脚手架的沉淀，所以，在新产品和新业务的生产过程中有大量的新组件、模块的开发工作，甚至要去修改库、框架和脚手架以提供新的技术能力。

从上述的前端技术发展脉络看，技术总是朝着易用、高效的方向发展，易用对应生产过程、高效对应生产效率，其次，才是技术带来的可能性。这个技术发展的规律就是螺旋式上升的过程，新技术带来可能性比如HTML、DHTML、HTTPWebRequest、Component甚至智能化，但是，只有易用和高效能带来工业化和规模，在产生商业价值的基础上，新技术才有可能走出温室在大众市场流行起来。

回到2019年双十一的生产过程中，所有新模块开发都是基于imgcook.com的Design to Code（D2C）能力自动生成，生成的代码有80%无任何研发介入修改，为什么还有大量的前端资源投入？为什么还有业务方反馈前端资源不足？其实，就是新技术的易用和高效未达成，不具备工业化和规模来推动技术的商业价值。反过来看，不具备工业化和规模不仅代表技术难用和低效，也意味着参与其中的人才素质不够、规模不大、工具不强、技术生态不全面等，这也是我希望解决的和文中想阐释的部分。

### 智能化发端

先看低效问题，"时间都去哪儿了？"这是双十一之后我提出的命题。如果借助人工智能和机器学习提供了前端极致模块生产力，为什么还有大量的人力资源投入？通过在志愿者的电脑上安装隐私保护的监控软件，我们公开收集了几个月的数据，从数据上进行分析和研究发现，约30%的时间耗费在各种需求评审会议上，约30%的时间耗费在答疑解惑上。因此，如果只从生产模块的角度调用几个模型的API服务，并不能解决零研发的问题，真正的零研发应该是建立在全新生产过程之上的全新生产力，而非极致生产力。

为了找到全新生产过程之上的全新生产力，我迫使自己回到十五年的软件研发经验中去。首先，我考察自己做开发的第一个五年。每次接到需求时大概率只是个粗放的Idea，这个Idea进入我脑海中后，我会搜索自己技术的"专家系统"试图解答这个Idea的可行性。PD收到我的反馈后会调整Idea，在PD的期望和我的反馈之间找到一个平衡点。然后，PD回去跟设计师PK，大概与跟我PK的过程相似，设计师会搜索他们设计的"专家系统"试图解答Idea长什么样？支持哪些交互方式？视觉上变化过程和结果是什么？PD收到设计师的反馈后会调整预期，在PD的预期和设计师的反馈之间找到一个平衡点。最后，PD把PK过程的产出物梳理一下形成一个完整的PRD、交互稿、视觉稿，在通过项目评审之后，交给我进行开发。开发过程中，先由PD讲解PRD，把PRD、交互稿、视觉稿缺失的信息通过讲解补全，再由我对所有细节对照技术实现手段进行概念的映射。比如：用户名输入、密码输入、登陆这三个产品概念，在技术实现上对应到文本输入、表单提交、鉴权、存储凭证等，把一系列产品概念翻译成技术实现上的概念，从而形成架构设计、概要设计、详细设计甚至代码。

其次，第二个五年里我会在上述生产过程之外，加入横向能力的思考。在技术上我一直秉持着一纵一横，一纵指的是在一个产品、一个业务、一件事儿上持续的学习、实践和积累，一横指的是在对这个产品、业务领域进行提炼和抽象，把提炼和抽象的结果用技术产品化的方式横向复用到更多产品、业务和事情上。

最后，在最近五年里我会在上述生产过程之外，加入全局视角。所谓全局视角犹如阿里前端委员会主席圆心在GMTC上分享的"双视角"一样，同时用业务视角和技术视角去看待生产过程。业务视角下技术能带来什么价值？技术视角下如何易用、高效支撑业务？

因此，回过头来看30%的时间耗费在各种需求评审会上就并不奇怪了。智能化的发端就在于：用机器学习的方法，借助过往沉淀的代码和数据，产出能模仿我每个五年软件生产过程的模型，从而替代我完成软件开发的工作。

### 智能化现状

既然问题分析清楚了，解题思路也有了，下面从我们做到的现状进行分析，之后再介绍过程中的核心智能化概念和方法。我们落地这个解题思路的核心产品是imgcook.com，imgcook.com的核心能力是Design to Code（D2C），D2C能力的核心是模仿前端工程师完成页面生产过程。这个探索和实现的过程经历了三个阶段：R2C、D2C、P2C。

- 第一阶段：

R2C指Rule to code也就是规则生成代码，借助设计稿约束规则和设计稿源文件分析规则结合，通过设计稿生成代码。当2018年9月来到杭州时，imgcook.com的前身“达芬奇”已经做了两年多了，为了配套达芬奇的设计稿生成代码能力，底层构建了数据标准化和统一投放体系，上层构建了方舟、命运石等业务平台，但能够解决的问题非常有限，只有严格遵守设计稿规范且比较简单的问题才能被“达芬奇”解决。深入分析，达芬奇依赖OpenCV技术对设计稿进行识别，OpenCV里需要大量的阈值约束才能达到比较好的效果。事实上，无论我们在OpenCV里怎么调整阈值，总是在各种Badcase中间闪转腾挪却不得其门而入，在设计稿无限的可能性和无限的设计师个人习惯之无限组合下，规则的复杂度爆炸，R2C无法实现替代程序员的目标。

- 第二阶段：

D2C指Design to code也就是设计稿生成代码，借助机器学习和计算机视觉对设计稿进行识别和理解，结合图像元素特征和上下文特征等信息，模型推理出元素是什么。这个过程用于解决R2C无法解决的规则爆炸问题，遇到无法确定规则的地方由模型进行识别。这个生产过程像极了前端的页面重构岗位，看设计稿、切图、编写UI和交互代码。2018年9月到2019年1月D2前端论坛宣布开放imgcook.com，我用近四个月的时间和达芬奇团队妙净、波本、卡狸、芸明等同学一起，完成了OpenCV阈值部分由模型替代的工作，在去规则上取得突破性的成果。

- 第三阶段：

P2C指Productive to code也就是产品化代码生成，借助需求结构化收集、需求理解、业务逻辑和代码逻辑片段理解、数据字段理解、API理解，完成从需求理解到业务逻辑生成，能够高效产品化的生成完整的业务交付物。这个生产过程超越了页面重构接近一个P5前端工程师的水平，能够用P2C的方式自动化完成常规前端业务开发工作。在页面重构到P5前端工程师的差距很大，无法一步到位。我们设计了一个三步走的路径：简单模块开发、复杂多态和交互模块开发、完整产品交付，从生产过程上可以划分为两个阶段：生产模块然后搭建，生产产品然后交付。

第一步：简单模块开发

何谓简单模块？我们定义为在双十一上使用的新模块，主要是老模块的设计稿缺失，迁移成本高。目标是双十一简单模块零研发，方案是在imgcook.com基础上，协同方舟（大促的搭建和投放系统）的墨溟等同学一起共建，用D2C能力供给模块、用方舟搭建投放消费模块。

项目开始前我在会议中提出：今天在过往大促代码的基础上我们如果能提炼和抽象出通用逻辑，再借助模型识别和推理确定使用哪些逻辑，我们就能够解决逻辑代码生成的问题，保证模块开发后能够在方舟上搭建使用。对内，由于大促模块数据驱动的特点，我们还针对imgcook.com的D2C能力在模块语义化和数据字段理解与匹配上引入了智能化能力。最终，通过上述方法的全新智能生产过程，我们在数据字段自动化绑定获得了30%的准确率、逻辑点识别和逻辑代码生成准确率超过60%、整体D2C代码可用率80%（生成代码后未被修改的比例），在两个月的时间里和方舟团队一起完成了双十一简单模块零研发的目标。

第二步：复杂多态和交互模块开发

在复杂多态和交互模块开发方面，智能生成遇到了D2C以来最大的困难：信息缺失。一个P5程序员能够完成开发，如前所述依赖于：PD讲解PRD，把PRD、交互稿、视觉稿缺失的信息通过讲解补全。那么，PRD、交互稿、视觉稿就是智能生成的基本条件。从现实情况来看，大部分PD不太能完整产出PRD、交互稿、视觉稿，同时，不同的习惯和不同的工具造成不同的产出物，增加了对PRD、交互稿、视觉稿理解的成本。视觉稿因为由图像领域工业化程度很高的模型能力决定，可以不做太多约束，从PD的视角看，今天C端业务基本都会和设计师一起产出视觉稿，否则项目评审都无法通过。PRD和交互稿的质量却是参差不齐、格式也是千差万别，结构化理解难度极高。对于信息缺失，通过对PRD和交互稿进行结构化约束，可以弥补无法获取完整产品设计信息的漏洞。




## 智能化定义
打通功能、智能和智力、智慧的边界，以人机协同的方式进行软件开发
人机协同的编程方式

## 智能化概念

### 功能(Capability)

### 智能(Intelligence)

### 智力(Intellect)

### 智慧(Wisdom)

## 智能化特性

### 确定性

### 鲁棒性

### 进化性

## 智能化原则

### 面向数据原则

### 实现之实现原则

### 人机竞合原则

### 反馈闭环原则

## 智能化模式

### 决策模式

### 创意模式

### 先验模式

### 后验模式

### 创建模式

### 结构模式

### 行为模式
